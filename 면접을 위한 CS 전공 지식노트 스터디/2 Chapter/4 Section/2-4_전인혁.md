# Section4. IP 주소

# 2.4.1 ARP

![Untitled](./2-4_%EC%A0%84%EC%9D%B8%ED%98%81_image/Untitled.png)

## ARP란?

- Address Resolution Protocol
- IP주소로부터 MAC 주소를 구하는 IP와 MAC 주소의 다리역할을 하는 프로토콜.
- **가상 주소인 IP 주소**를 실제 주소인 MAC 주소로 변환.
- 이와 반대로 **RARP**를 통해,
  - **실제 주소인 MAC주소**를, **가상 주소인 IP주소**로 변환하기도 함.

## ARP가 주소를 찾는 과정

![Untitled](./2-4_%EC%A0%84%EC%9D%B8%ED%98%81_image/Untitled%201.png)

1. A가 브로드 캐스트로 120.79.80.3에 해당하는 MAC 주소 찾는다.
2. 해당 주소에 맞는 B가 ARP reply 유니캐스트를 통해 MAC 주소를 반환.

- 브로드 캐스트 : 송신 호스트가 전송한 데이터가, 네트워크의 모든 호스트에게 전송됨.
- 유니캐스트 : 고유 주소로 식별된 하나의 네트워크 목적지에 1:1로 데이터를 전송

# 2.4.2 홉바이홉 통신

### 홉바이홉 통신이란?

- IP 주소를 통해 통신하는 과정.
- 홉이란?
  - 영어 자체로는 건너뛰는 모습을 뜻함.
  - 각 패킷이 여러 개의 라우터를 건너가는 모습을 비유적으로 표현한 것.
  - 각 라우터에 있는 라우팅 테이블의 IP를 기반으로 패킷을 전달하고 다시 전달해나감.
    ![Untitled](./2-4_%EC%A0%84%EC%9D%B8%ED%98%81_image/Untitled%202.png)
- 즉, 통신장치의 ‘라우팅 테이블’의 IP를 통해,
  - 시작주소부터 다음 IP로 계속해서 이동하는 ‘**라우팅**’ 과정을 거쳐
  - **패킷이 최종 목적지까지 도달하는 통신**을 뜻함.

### 라우팅 테이블이란?

- 송신지에서 수신지까지 도달하기 위해 사용됨.
- 라우터에 들어있는 목적지 정보들과 그 목적지로 가기위한 방법이 들어있는 리스트.
- 게이트웨이와 모든 목적지에 대해 해당 목적지에 도달하기 위해 거쳐야할 다음 라우터의 정보를 가짐.

### 게이트웨이

![Untitled](./2-4_%EC%A0%84%EC%9D%B8%ED%98%81_image/Untitled%203.png)

- 서로다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어.
- 사용자는 인터넷 접속을 위해 게이트웨이를 거쳐야 함.
- 게이트웨이는, 서로 다른 네트워크 상의 통신 프로토콜을 변환해주는 역할을 함.
- 라우팅 테이블에서 이를 확인할 수 있으며, 윈도우의 `netstat -r` 명령어로 확인 가능.

# 2.4.3 IP 주소체계.

### 종류

- **IPv4**
  - 32비트를 8비트 단위로 점을 찍어 표기
  - ex) 123.45.67.89
- **IPv6**

  - 64비트를 16비트 단위로 점을 찍어 표기
  - ex) 2001:db8::ff00:43:8329

- 현재 추세는 IPv6를 향해 가고 있지만, 아직까지는 IPv4가 많이 사용된다.

### 클래스 기반 할당방식(CIDR)

- IP주소 체계는 계속 발전해오고 있음.
- 최초에는 **A, B, C, D, E 다섯개의 클래스**로 구분하는 클래스 기반 할당방식을 사용.
- **앞부분을 네트워크 주소**, 그 **뒤 부분을 컴퓨터에 부여하는 호스트 주소**로 놓아서 사용.
  ![Untitled](./2-4_%EC%A0%84%EC%9D%B8%ED%98%81_image/Untitled%204.png)
  - A, B, C 클래스는 일대일 통신에 사용.
  - D클래스는 멀티캐스틑 오신에 사용
  - E는 예비용.
- 클래스 기반 할당방식 상세
  ![Untitled](./2-4_%EC%A0%84%EC%9D%B8%ED%98%81_image/Untitled%205.png)
  - 맨 왼쪽 비트 = 구분비트.
  - 각 클래스에서의 구분비트
    - A클래스 : 0
    - B클래스 : 10
    - C클래스 : 110

### 클래스 기반 할당방식의 단점

![Untitled](./2-4_%EC%A0%84%EC%9D%B8%ED%98%81_image/Untitled%206.png)

- 네트워크의 **첫번째 주소**는 **네트워크 주소**로 사용.
- **마지막 주소**는 **브로드캐스트용 주소**로, 네트워크에 속한 모든 컴퓨터에게 데이터 보낼 때 사용

  - 만약, 클래스 A로부터 12.0.0.0 을 부여받으면,
  - 12.0.0.0은 네트워크 구별주소이므로 사용불가.
  - 12.255.255.255는 브로드캐스트용으로 남겨두어야 하기때문에 사 용불가.
  - 따라서, 그 사이의 12.0.0.1 ~ 12.255.255.254를 호스트 주소로 사용가능.

- 이 방식은 사용하는 주소보다 버리는 주소가 많다는 단점이 있음.
- 이를 해소하기 위해, DHCP와 IPv6, NAT가 등장.

### DHCP

- Dynamic Host Configuration Protocol
- IP주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜
- 네트워크 장치의 IP주소를 수동으로 설정할 필요없이,
  - 인터넷 접속시마다 자동으로 IP주소를 할당할 수 있음.
- 많은 라우터와 게이트웨이 장비에는 DHCP 기능이 있음.

### NAT

- Network Address Translation
- 패킷이 라우팅 장치를 통해 전송되는 동안,
  - 패킷의 IP 주소 정보를 수정하여 IP 주소를 다른 주소로 매핑하는 방법.
  - IPv4 주소 체계만으로는 많은 주소들을 감당하지 못하는 단점을 보완
- NAT를 활용해 공인 IP와 사설 IP로 나눠서 많은 주소를 처리.

![Untitled](./2-4_%EC%A0%84%EC%9D%B8%ED%98%81_image/Untitled%207.png)

- 192.168.0.xxx는 사설 ip.
- NAT 장치를 통해 최종적으로 라우터에서는 121.165.151.200라는 공인 IP로 외부 인터넷에 요청.
- **인터넷 공유기에는 NAT 기능이 탑재되어 있기 때문에, 하나의 아이피로 여러 사설 IP를 개통하여 이용가능.**

### NAT 의 장/단점

- 장점 : 내부 네트워크에서 사용하는 IP주소와 외부 IP 주소가 다르기 때문에, 내부 네트워크에 대한 보안 가능
- 단점 : 여러명이 동시에 사용하기 때문에, 실제 접속하는 호스트 숫자에 따라 접속 속도가 느려질 수도 있음.

# 2.4.4 IP 주소를 이용한 위치 정보

- IP주소는 인터넷에서 사용하는 네트워크 주소이기 때문에, 동/구까지는 추적 가능.
- http://mylocation.co.kr
